<!-- START: Cookie Consent (VirtualLaunch.Pro) -->
<div
  id="vlp-cookie"
  aria-label="Cookie preferences"
  aria-live="polite"
  class="fixed bottom-4 left-4 right-4 z-[9999] hidden max-w-3xl rounded-2xl border border-white/10 bg-white/5 p-4 shadow-soft backdrop-blur md:left-6 md:right-auto md:p-5"
>
  <div class="flex flex-col gap-4 md:flex-row md:items-start md:gap-5">
    <div class="min-w-0 flex-1">
      <p class="text-sm font-extrabold text-white">We use cookies</p>
      <p class="mt-1 text-xs leading-relaxed text-white/70">
        We use essential cookies for site functionality, and optional analytics cookies to improve performance.
        You can accept, reject, or manage preferences at any time.
      </p>
      <div class="mt-3 flex flex-wrap items-center gap-x-3 gap-y-2">
        <button
          id="vlp-cookie-open"
          class="text-xs font-extrabold text-brand-400 underline decoration-white/20 underline-offset-4 hover:text-brand-300"
          type="button"
        >
          Manage cookies
        </button>
        <a
          href="/privacy/"
          class="text-xs font-semibold text-white/70 underline decoration-white/15 underline-offset-4 hover:text-white/90"
          rel="noopener"
        >
          Privacy policy
        </a>
      </div>
    </div>

    <div class="flex flex-wrap gap-2 md:flex-col md:items-stretch md:gap-3">
      <button
        id="vlp-cookie-accept"
        class="inline-flex items-center justify-center rounded-xl bg-brand-500 px-4 py-3 text-xs font-extrabold text-ink-900 hover:bg-brand-400"
        type="button"
      >
        Accept all
      </button>
      <button
        id="vlp-cookie-reject"
        class="inline-flex items-center justify-center rounded-xl border border-white/15 bg-white/5 px-4 py-3 text-xs font-extrabold text-white/85 hover:border-white/25 hover:bg-white/10"
        type="button"
      >
        Reject non-essential
      </button>
    </div>
  </div>

  <!-- START: Cookie Preferences Panel -->
  <div id="vlp-cookie-panel" class="mt-4 hidden rounded-2xl border border-white/10 bg-black/20 p-4">
    <div class="flex flex-col gap-3">
      <div class="flex items-start justify-between gap-4">
        <div class="min-w-0">
          <p class="text-xs font-extrabold text-white">Cookie preferences</p>
          <p class="mt-1 text-xs text-white/70">
            Essential cookies are always on. Toggle analytics below.
          </p>
        </div>
        <button
          id="vlp-cookie-close"
          class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-extrabold text-white/80 hover:border-white/20 hover:bg-white/10"
          type="button"
        >
          Close
        </button>
      </div>

      <div class="rounded-2xl border border-white/10 bg-white/5 p-3">
        <div class="flex items-start justify-between gap-4">
          <div class="min-w-0">
            <p class="text-xs font-extrabold text-white">Essential</p>
            <p class="mt-1 text-xs text-white/70">
              Required for security, navigation, and saving your cookie choices.
            </p>
          </div>
          <span class="inline-flex items-center rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] font-extrabold text-white/70">
            Always on
          </span>
        </div>
      </div>

      <div class="rounded-2xl border border-white/10 bg-white/5 p-3">
        <div class="flex items-start justify-between gap-4">
          <div class="min-w-0">
            <p class="text-xs font-extrabold text-white">Analytics</p>
            <p class="mt-1 text-xs text-white/70">
              Helps us understand usage and improve pages (e.g., anonymized metrics).
            </p>
          </div>

          <button
            id="vlp-cookie-toggle-analytics"
            aria-checked="false"
            aria-label="Toggle analytics cookies"
            role="switch"
            class="relative h-8 w-14 rounded-full border border-white/15 bg-white/10 transition"
            type="button"
          >
            <span
              id="vlp-cookie-toggle-analytics-knob"
              class="absolute left-1 top-1 h-6 w-6 rounded-full bg-white/80 transition"
            ></span>
          </button>
        </div>
      </div>

      <div class="flex flex-wrap gap-2">
        <button
          id="vlp-cookie-save"
          class="inline-flex items-center justify-center rounded-xl bg-brand-500 px-4 py-3 text-xs font-extrabold text-ink-900 hover:bg-brand-400"
          type="button"
        >
          Save preferences
        </button>
        <button
          id="vlp-cookie-accept-analytics"
          class="inline-flex items-center justify-center rounded-xl border border-white/15 bg-white/5 px-4 py-3 text-xs font-extrabold text-white/85 hover:border-white/25 hover:bg-white/10"
          type="button"
        >
          Accept analytics
        </button>
      </div>
    </div>
  </div>
</div>

<script>
(function () {
  var KEY = 'vlp_cookie_prefs_v1';
  var banner = document.getElementById('vlp-cookie');
  var panel = document.getElementById('vlp-cookie-panel');

  var btnAccept = document.getElementById('vlp-cookie-accept');
  var btnReject = document.getElementById('vlp-cookie-reject');
  var btnOpen = document.getElementById('vlp-cookie-open');
  var btnClose = document.getElementById('vlp-cookie-close');
  var btnSave = document.getElementById('vlp-cookie-save');
  var btnAcceptAnalytics = document.getElementById('vlp-cookie-accept-analytics');

  var toggle = document.getElementById('vlp-cookie-toggle-analytics');
  var knob = document.getElementById('vlp-cookie-toggle-analytics-knob');

  if (!banner || !panel || !toggle || !knob) return;

  function safeParse(json) {
    try {
      return JSON.parse(json);
    } catch (e) {
      return null;
    }
  }

  function getPrefs() {
    var raw = null;
    try {
      raw = localStorage.getItem(KEY);
    } catch (e) {}
    if (!raw) return null;
    return safeParse(raw);
  }

  function setPrefs(prefs) {
    try {
      localStorage.setItem(KEY, JSON.stringify(prefs));
    } catch (e) {}
  }

  function applyAnalyticsConsent(enabled) {
    // Hook your analytics loader here.
    // Example: if (enabled) { load GA/Plausible/etc. }
    // Keep this function idempotent.
    if (!enabled) return;
  }

  function setToggleState(on) {
    toggle.setAttribute('aria-checked', on ? 'true' : 'false');
    knob.style.transform = on ? 'translateX(24px)' : 'translateX(0px)';
    toggle.style.backgroundColor = on ? 'rgba(249,115,22,0.35)' : 'rgba(255,255,255,0.10)';
    toggle.style.borderColor = on ? 'rgba(249,115,22,0.45)' : 'rgba(255,255,255,0.15)';
  }

  function hideBanner() {
    banner.classList.add('hidden');
  }

  function showBanner() {
    banner.classList.remove('hidden');
  }

  function openPanel() {
    panel.classList.remove('hidden');
  }

  function closePanel() {
    panel.classList.add('hidden');
  }

  function init() {
    var prefs = getPrefs();
    if (!prefs) {
      setToggleState(false);
      showBanner();
      closePanel();
      return;
    }

    setToggleState(!!prefs.analytics);
    hideBanner();
    applyAnalyticsConsent(!!prefs.analytics);
  }

  btnOpen.addEventListener('click', function () {
    openPanel();
  });

  if (btnClose) {
    btnClose.addEventListener('click', function () {
      closePanel();
    });
  }

  toggle.addEventListener('click', function () {
    var current = toggle.getAttribute('aria-checked') === 'true';
    setToggleState(!current);
  });

  btnAccept.addEventListener('click', function () {
    var prefs = { analytics: true, ts: Date.now() };
    setPrefs(prefs);
    applyAnalyticsConsent(true);
    hideBanner();
  });

  btnReject.addEventListener('click', function () {
    var prefs = { analytics: false, ts: Date.now() };
    setPrefs(prefs);
    hideBanner();
  });

  if (btnAcceptAnalytics) {
    btnAcceptAnalytics.addEventListener('click', function () {
      var prefs = { analytics: true, ts: Date.now() };
      setPrefs(prefs);
      applyAnalyticsConsent(true);
      hideBanner();
    });
  }

  if (btnSave) {
    btnSave.addEventListener('click', function () {
      var on = toggle.getAttribute('aria-checked') === 'true';
      var prefs = { analytics: on, ts: Date.now() };
      setPrefs(prefs);
      applyAnalyticsConsent(on);
      hideBanner();
    });
  }

  init();
})();
</script>
<!-- START: Cookie Consent (VirtualLaunch.Pro) -->
